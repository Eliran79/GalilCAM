<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>GalilCAM</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
     * element that contains the map. */
      /* Optional: Makes the sample page fill the window. */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: auto;
      }

      .strokeme {
        color: white;
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000,
          1px 1px 0 #000;
      }
    </style>
  </head>
  <body style="background-color: black; font-family: arial">
    <div id="map" style="width:100%; height:100%; z-index: 100"></div>
    <script
      src="https://code.jquery.com/jquery-3.4.1.js"
      integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
      crossorigin="anonymous"
    ></script>
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 33.0066357, lng: 35.0912991 },
          zoom: 15,
          mapTypeControl: false,
          mapTypeId: 'satellite'
        });
        map.setTilt(45)
        var iconN = {
          url: "n.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconNE = {
          url: "ne.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconE = {
          url: "e.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconSE = {
          url: "se.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconS = {
          url: "s.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconSW = {
          url: "sw.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconW = {
          url: "w.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        var iconNW = {
          url: "nw.svg",
          scaledSize: new google.maps.Size(20, 20),
          origin: new google.maps.Point(0, 0),
          anchor: new google.maps.Point(0, 0)
        };
        <% for(var i = 0; i<cameras.length; i++){ %>
          var contentString<%= i %> = '<h2 style="text-align: center">Info</h2>' +
                                      '<p>Type: <%= cameras[i].TypeMobile %>' +
                                      '<p>Info: <%= cameras[i].CameraINFO %>' +
                                      '<p>Angle: <%= cameras[i].Angle %>\u00B0'
          var infowindow<%= i %> = new google.maps.InfoWindow({
            content: contentString<%= i %>
          });
          var marker<%= i %> = new google.maps.Marker({
            position: { lat: <%= cameras[i].X %>, lng: <%= cameras[i].Y %> },
            map: map,
            <% if(cameras[i].Direction == "דרום"){ %>
              icon: iconS
            <% } else if(cameras[i].Direction == "דרום מזרח"){ %>
              icon: iconSE
            <% } else if(cameras[i].Direction == "דרום מערב"){ %>
              icon: iconSW
            <% } else if(cameras[i].Direction == "מזרח"){ %>
              icon: iconE
            <% } else if(cameras[i].Direction == "מערב"){ %>
              icon: iconW
            <% } else if(cameras[i].Direction == "צפון מערב"){ %>
              icon: iconNW
            <% } else { %>
              icon: iconN
            <% } %>
          });
          marker<%= i %>.addListener('click', function() {
            infowindow<%= i %>.open(map, marker<%= i %>)
          })
        <% } %>

        var trafficLayer = new google.maps.TrafficLayer();

        trafficLayer.setMap(map);
      }
    </script>

    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDXY_aO0xDGZX4BSOkw8w88wLpp0Q7HTIQ&callback=initMap"
      async
      defer
    ></script>
  </body>
</html>
